<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Homepage</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.6/dist/css/bootstrap-select.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js">
        integrity = "sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin = "anonymous" ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"
        integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js"
        integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.6/dist/js/bootstrap-select.min.js"></script>
</head>

<!-- HTML containing a form with 10 questions to determine the most compatible match based on the existing users -->
<body>
    <div class="container">

        <div id="myModal" class="modal"
            style="width:50%; text-align: center; margin-left: 25%; margin-right:25%; margin-top: 5%;">

            <!-- Modal content -->
            <div class="modal-content" style="background-color:lightgray; padding:4%">
                <h1>Your most compatible companion is:</h1>
                <h2 class="companion"></h2>
                <img class="companionImage" src="" style="width:50%; height: auto; margin-left:25%; margin-right:25%">


                <span class="close" style="padding:2%">EXIT</span>

            </div>

        </div>

        <h1>Survey Questions</h1>

        <hr>

        <h2 style="font-weight: bold">About You</h2>
<!-- Survey Questions. Everything needs to be filld out for a valid submission -->
        <form>
            <div class="form-group">
                <label for="user-name">Name (required)</label>
                <input type="text" class="form-control" id="user-name">
            </div>
            <div class="form-group">
                <label for="user-image">Link to Photo (required)</label>
                <input type="text" class="form-control" id="user-image">
            </div>
        </form>
        <h3 style="font-weight: bold">Question 1</h3>
        <h4>I love a good party</h4>
        <select id="q1" class="selectpicker">
            <option value="default" selected="selected">Choose an answer</option>
            <option>1 (Strongly Disagree)</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5 (Strongly Agree)</option>
        </select>

        <h3 style="font-weight: bold">Question 2</h3>
        <h4>I like to keep a tight schedule</h4>
        <select id="q2" class="selectpicker">
            <option value="default" selected="selected">Choose an answer</option>
            <option>1 (Strongly Disagree)</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5 (Strongly Agree)</option>
        </select>

        <h3 style="font-weight: bold">Question 3</h3>
        <h4>I keep a very clean house</h4>
        <select id="q3" class="selectpicker">
            <option value="default" selected="selected">Choose an answer</option>
            <option>1 (Strongly Disagree)</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5 (Strongly Agree)</option>
        </select>

        <h3 style="font-weight: bold">Question 4</h3>
        <h4>I am a social butterfly</h4>
        <select id="q4" class="selectpicker">
                <option value="default" selected="selected">Choose an answer</option>
            <option>1 (Strongly Disagree)</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5 (Strongly Agree)</option>
        </select>

        <h3 style="font-weight: bold">Question 5</h3>
        <h4>I am more logical than emotional</h4>
        <select id="q5" class="selectpicker">
                <option value="default" selected="selected">Choose an answer</option>
            <option>1 (Strongly Disagree)</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5 (Strongly Agree)</option>
        </select>

        <h3 style="font-weight: bold">Question 6</h3>
        <h4>I love to travel to exotic places</h4>
        <select id="q6" class="selectpicker">
            <option value="default" selected="selected">Choose an answer</option>
            <option>1 (Strongly Disagree)</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5 (Strongly Agree)</option>
        </select>

        <h3 style="font-weight: bold">Question 7</h3>
        <h4>I am very sensitive</h4>
        <select id="q7" class="selectpicker">
            <option value="default" selected="selected">Choose an answer</option>
            <option>1 (Strongly Disagree)</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5 (Strongly Agree)</option>
        </select>

        <h3 style="font-weight: bold">Question 8</h3>
        <h4>I am very competitive</h4>
        <select id="q8" class="selectpicker">
            <option value="default" selected="selected">Choose an answer</option>
            <option>1 (Strongly Disagree)</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5 (Strongly Agree)</option>
        </select>

        <h3 style="font-weight: bold">Question 9</h3>
        <h4>I like a lot of alone time</h4>
        <select id="q9" class="selectpicker">
            <option value="default" selected="selected">Choose an answer</option>
            <option>1 (Strongly Disagree)</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5 (Strongly Agree)</option>
        </select>

        <h3 style="font-weight: bold">Question 10</h3>
        <h4>I have many friends</h4>
        <select id="q10" class="selectpicker">
            <option value="default" selected="selected">Choose an answer</option>
            <option>1 (Strongly Disagree)</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5 (Strongly Agree)</option>
        </select>
        <br><br>
        <button id="submit" type="submit" class="btn btn-primary btn-lg btn-block"><span class="fa fa-check-circle"
                aria-hidden="true"></i>
                Submit</button>

</body>

</html>

<script type="text/javascript">
        $("#submit").on("click", function (event) {
            event.preventDefault();

            var newFriend = {
                name: $("#user-name").val().trim(),
                photo: $("#user-image").val().trim(),
                scores: [
                    parseInt($("#q1").val()),
                    parseInt($("#q2").val()),
                    parseInt($("#q3").val()),
                    parseInt($("#q4").val()),
                    parseInt($("#q5").val()),
                    parseInt($("#q6").val()),
                    parseInt($("#q7").val()),
                    parseInt($("#q8").val()),
                    parseInt($("#q9").val()),
                    parseInt($("#q10").val()),
                ]
            }

            var allQuestionsAnswered = 0;

            for (i = 0; i < 10; i++) {
                allQuestionsAnswered += parseInt(newFriend.scores[i])
            }

            if (newFriend.name != "" && newFriend.photo != "" && isNaN(allQuestionsAnswered) === false) {
                $.post("/api/friends", newFriend)
                    .done(function (data) {
                        console.log(data);
                        $('.modal').fadeIn();
                        $('.companion').html(data.name);
                        $('.companionImage').attr("src", data.photo);
                    })
            } else {
                alert("Please answer all questions");
            };
        });

    $('.close').on('click', function () {
        $("#user-name").val("");
        $("#user-image").val("");
        $("#q1").val("default");
        $("#q1").selectpicker("refresh");
        $("#q2").val("default");
        $("#q2").selectpicker("refresh");
        $("#q3").val("default");
        $("#q3").selectpicker("refresh");
        $("#q4").val("default");
        $("#q4").selectpicker("refresh");
        $("#q5").val("default");
        $("#q5").selectpicker("refresh");
        $("#q6").val("default");
        $("#q6").selectpicker("refresh");
        $("#q7").val("default");
        $("#q7").selectpicker("refresh");
        $("#q8").val("default");
        $("#q8").selectpicker("refresh");
        $("#q9").val("default");
        $("#q9").selectpicker("refresh");
        $("#q10").val("default");
        $("#q10").selectpicker("refresh");
        $('.modal').fadeOut();
    });

</script>